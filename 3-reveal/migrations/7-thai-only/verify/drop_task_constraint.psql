-- Verify thailand_only:drop_task_constraint on pg

BEGIN;

SET search_path TO :"schema",public;

SELECT 1/COUNT(*)
FROM (
    SELECT COUNT(*)
    FROM pg_catalog.pg_constraint
    WHERE
    conname = 'fk_events_task'
    AND conrelid = CONCAT(:'schema', '.events')::regclass
    AND contype = 'f'
    AND 1 = ALL(conkey)
    AND 1 = ALL(confkey)
) AS foo
WHERE count = 0;

ROLLBACK;
